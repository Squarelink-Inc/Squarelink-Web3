var squarelink=function(e,n,t,r,o,i,a,u){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,n=n&&n.hasOwnProperty("default")?n.default:n,t=t&&t.hasOwnProperty("default")?t.default:t,r=r&&r.hasOwnProperty("default")?r.default:r,o=o&&o.hasOwnProperty("default")?o.default:o,i=i&&i.hasOwnProperty("default")?i.default:i,a=a&&a.hasOwnProperty("default")?a.default:a,u=u&&u.hasOwnProperty("default")?u.default:u;var c,s,l,f="https://app.squarelink.com",p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h=(c="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,function(){function e(e){this.value=e}function n(n){var t,r;function o(t,r){try{var a=n[t](r),u=a.value;u instanceof e?Promise.resolve(u.value).then(function(e){o("next",e)},function(e){o("throw",e)}):i(a.done?"return":"normal",a.value)}catch(e){i("throw",e)}}function i(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?o(t.key,t.arg):r=null}this._invoke=function(e,n){return new Promise(function(i,a){var u={key:e,arg:n,resolve:i,reject:a,next:null};r?r=r.next=u:(t=r=u,o(e,n))})},"function"!=typeof n.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(e){return this._invoke("next",e)},n.prototype.throw=function(e){return this._invoke("throw",e)},n.prototype.return=function(e){return this._invoke("return",e)}}(),function(e){return function(){var n=e.apply(this,arguments);return new Promise(function(e,t){return function r(o,i){try{var a=n[o](i),u=a.value}catch(e){return void t(e)}if(!a.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}("next")})}}),d=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},v=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),w=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},m=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)},g=function(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n},y=("undefined"==typeof global?self:global,function(){}(),function(e){function n(e){d(this,n);var t=g(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.name="[Squarelink Error]",t}return m(n,e),n}(Error)),b=["mainnet","kovan","rinkeby","ropsten"],k=function(e){var n=[];for(var t in e)e.hasOwnProperty(t)&&n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&")},_=function(e){return new Promise(function(n,t){var r=window.open(e,"Squarelink","scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no,width=425,height=700,left=-500,top=150");r.focus(),window.addEventListener("message",function(e){"squarelink"===e.data.origin&&(window.removeEventListener("message",function(){}),r.close(),n(w({},e.data,{origin:void 0})))},!1)})},P=function(e){e.client_id;var n=e.network;if("object"===(void 0===n?"undefined":p(n))){if(!n.url)throw new y("Please provide an RPC endpoint for your custom network");if(!n.url.match(/http[s]?:(\/?\/?)[^\s]+/))throw new y("We do not currently support non-http(s) RPC connections. Try updating squarelink to its latest version!");if(n.chainId&&(n.chainId!==parseInt(n.chainId)||n.chainId<0||n.chainId>5e5))throw new y("Please provide a valid Chain ID")}else if(!b.includes(n))throw new y("Invalid network provided")},R=function(e){var n=e.network,t=e.client_id;return"object"===(void 0===n?"undefined":p(n))?n.url:"https://web3.squarelink.com/"+n+"/"+t},x=function(){var e="localhost"===location.hostname||"127.0.0.1"===location.hostname,n="https:"===location.protocol;if(!(e||n))throw new y("Access to the Squarelink Web3 Engine is restricted to secure origins.\nIf this is a development environment please use http://localhost:"+location.port+" instead.\nOtherwise, please use an SSL certificate.")},S=global.fetch||require("fetch-ponyfill")().fetch,O=function(e){var n,t=this;return new Promise((n=h(regeneratorRuntime.mark(function n(r,o){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:_(f+"/authorize?client_id="+e+"&scope=[wallets:read]&response_type=token&widget=true&version=0.1.1").then(function(e){var n,i=e.error,a=e.result;i&&o(new y(i)),S("https://api.squarelink.com/wallets?"+k({access_token:a})).then((n=h(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:(n=e.sent).success?r(n.wallets.map(function(e){return e.address})):o(new y(n.message||"Issue fetching accounts, try again later"));case 4:case"end":return e.stop()}},e,t)})),function(e){return n.apply(this,arguments)}))});case 2:case"end":return n.stop()}},n,t)})),function(e,t){return n.apply(this,arguments)}))},I=(s=h(regeneratorRuntime.mark(function e(n){var t,r=n.client_id,o=n.message,i=n.params,a=n.method,u=n.account;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=f+"/msg?client_id="+r+"&method="+(a||"signMessage")+"&version=0.1.1",u&&(t=t+"&account="+u),t="signTypedMessage"===a?t+"&params="+k(i):t+"&msg="+o,e.abrupt("return",_(t).then(function(e){var n=e.error,t=e.result;if(n)throw new y(n);return Promise.resolve(t)}));case 4:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)}),j=(l=h(regeneratorRuntime.mark(function e(n){var t,r=n.method,o=n.client_id,i=n.value,a=n.to,u=n.from,c=n.gas,s=n.gasPrice,l=n.nonce,h=n.network,d=n.description,v=n.state,w=n.data;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f+"/tx?widget=true&method="+r+"&client_id="+o+"&version=0.1.1",a){e.next=3;break}throw new y("You must provide a recipient `to` for the request");case 3:return t=t+"&to="+a,i&&(t=t+"&value="+parseInt(i,16)),u&&(t=t+"&from="+u),c&&(t=t+"&gas="+parseInt(c,16)),s&&(t=t+"&gasPrice="+Math.pow(10,-9)*parseInt(s,16)),l&&(t=t+"&nonce="+parseInt(l,16)),d&&(t=t+"&description="+d),v&&(t=t+"&state="+v),w&&(t=t+"&data="+w),"object"===(void 0===h?"undefined":p(h))?(t=t+"&network=custom&rpc_url="+h.url,h.chainId&&(t=t+"&chain_id="+h.chainId)):t=t+"&network="+h,w&&(t=t+"&data="+w),e.abrupt("return",_(t).then(function(e){var n=e.error,t=e.result;if(n)throw new y(n);return Promise.resolve(t)}));case 15:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)});return function(){function c(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mainnet";d(this,c),this.client_id=e,x(),P({client_id:e,network:n}),this.network=n,this.rpcEndpoint=R({client_id:e,network:n}),this._initEngine()}return v(c,[{key:"getProvider",value:function(){return this.engine}},{key:"changeNetwork",value:function(e){var n=this.client_id;P({client_id:n,network:e}),this.network=e,this.rpcEndpoint=R({client_id:n,network:e}),this._initEngine()}},{key:"_initEngine",value:function(){var c=this,s=this;this.accounts=[];var l=new e;l.isSquarelink=!0,l.isConnected=function(){return!0},l.addProvider(new t({web3_clientVersion:"Squarelink/0.1.1/javascript",net_listening:!0,eth_hashrate:"0x00",eth_mining:!1,eth_syncing:!0})),l.addProvider(new n),l.addProvider(new r),l.addProvider(new a),l.addProvider(new o),l.addProvider(new i({getAccounts:function(){var e=h(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s.accounts.length?n(null,s.accounts):O(s.client_id).then(function(e){s.accounts=e,n(null,e)}).catch(function(e){return n(e,null)});case 1:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}(),getCoinbase:function(){var e=h(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.getAccounts().then(function(e){return n(null,e[0])}).catch(function(e){return n(e,null)});case 1:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}(),signTransaction:function(){var e=h(regeneratorRuntime.mark(function e(n,t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"number"==typeof(r=n.from)&&(r=s.accounts[r]),j(w({},n,{from:r,method:"eth_signTransaction",client_id:s.client_id,network:s.network})).then(function(e){return t(null,e)}).catch(function(e){return t(e,null)});case 3:case"end":return e.stop()}},e,this)}));return function(n,t){return e.apply(this,arguments)}}(),signMessage:function(){var e=h(regeneratorRuntime.mark(function e(n,t){var r,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.from,o=n.data,i=n.method,"number"==typeof r&&(r=s.accounts[r]),I({client_id:s.client_id,method:i||"eth_signMessage",message:o,account:r}).then(function(e){return t(null,e)}).catch(function(e){return t(e,null)});case 3:case"end":return e.stop()}},e,this)}));return function(n,t){return e.apply(this,arguments)}}(),signPersonalMessage:function(){var e=h(regeneratorRuntime.mark(function e(n,t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.signMessage(n).then(function(e){return t(null,e)}).catch(function(e){return t(e,null)});case 1:case"end":return e.stop()}},e,this)}));return function(n,t){return e.apply(this,arguments)}}(),signTypedMessage:function(){var e=h(regeneratorRuntime.mark(function e(n,t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.signMessage(w({},n,{method:"eth_signTypedData"})).then(function(e){return t(null,e)}).catch(function(e){return t(e,null)});case 1:case"end":return e.stop()}},e,this)}));return function(n,t){return e.apply(this,arguments)}}(),signTypedMessageV3:function(){var e=h(regeneratorRuntime.mark(function e(n,t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.signMessage(w({},n,{method:"eth_signTypedData_v3"})).then(function(e){return t(null,e)}).catch(function(e){return t(e,null)});case 1:case"end":return e.stop()}},e,this)}));return function(n,t){return e.apply(this,arguments)}}(),getGasPrice:function(){var e=h(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n(null,"");case 1:case"end":return e.stop()}},e,c)}));return function(n){return e.apply(this,arguments)}}()}),0),l.addProvider(new u({rpcUrl:this.rpcEndpoint})),l.on("error",function(e){console.error(e.stack)}),l.start(),this.engine=l}}]),c}()}(ProviderEngine,CacheSubprovider,FixtureSubprovider,FilterSubprovider,VmSubprovider,HookedWalletSubprovider,NonceSubprovider,RpcSubprovider);
//# sourceMappingURL=squarelink.min.js.map
